### install java dist:

- https://aws.amazon.com/corretto

```bash
java -version # test installation
```

# Java ecosystem

The Java ecosystem is a collection of tools, frameworks, and libraries:

|                                |                                                                                      |
| ------------------------------ | ------------------------------------------------------------------------------------ |
| The Java Development Kit (JDK) | Development tools, runtime, standard libs                                            |
| JVM                            | virtual machine that `platform-independent` run `Java/ Scala/ Kotlin`                |
| Java EE (Enterprise Edition)   | `Java EE` built-upon `Java SE (standard edition)` for enterprise-level applications. |
| `Spring`                       | Java web frameworks                                                                  |
| `Maven` and `Gradle`           | Build tools                                                                          |
| `IntelliJ IDEA`                | IDE                                                                                  |
| `Jshell`                       | (Read-Eval-Print Loop (REPL))to learn the syntax                                     |

- JVM
  - Java/ Scala/ Kotlin `src code` is `compiled into bytecode` (may also packaged into jar)
  - JVM `runs bytecode`, and platform-independent
  - JVM provides
    - built-in `memory management`
    - automatic `garbage collection`
    - 一定效率影响

# Java Project (`Maven`)

- Maven

  - `Project Management`: boilerplate code, project structure, dependencies management
  - `build tool`: compile, run tests, package, install, document generation

- dependencies: typically referred to as `library`
  - `Central Maven Repository`: repository server for download.
  - `Local Maven Repository`: inside you localhost

### Project components

- `src`
  - `source files(.java )`: contains source codes: classes, Enums.
  - `package`: packages are essentially `folder`, contains nest packages or source files
  - `resources`: non-source code, like xml, csv, properties...
  - `test`: unit test or integration test source file
- `targets`:

  - `mvn compile` +=> `.class`: compiled bytecode. (def: platform-independent, low-level code for JVM)
  - `mvn package` ==> `.jars (Java Archive)`: essentially archive file packaging `.class` files, resources, metadata
  - `generated source code`

### `pom.xml`

- metadata

  - `modelVersion`: pom version
  - `groupId`: the organization => com.example.demo
  - `artifactId`: name of the applicaiton => my-maven-app
  - `version`: SNAPSHOT(dev), RELEASE
  - `properties`: specify versions that can be referenced

- `dependencies` (不熟)

  - `scope`: dependency visibility:
    - compile: (default, available during compile, test, and runtime)
    - test: used only for testing
    - provided(not available in runtime), runtime(not available in compile), system(provide a path to dependency)
  - `exclusions`: exclude dependency of a dependency (eg, you explicitly use another version of the dependency)

- `build`: contains configuration and settings related to the build process

  - `sourceDirectory`: Specifies the source code directory
  - `testSourceDirectory`: Specifies the source code directory for test.
  - `resources`: Specifies the resource directory
  - `extensions`: Enables Maven built-in plugin (extensions)
  - `plugins`: script to run in build process for specific purpose

- `profile`
```xml
<modelVersion>4.0.0</modelVersion>  <!-- version of pom-->
<!-- metadata -->
<groupId>com.example</groupId>
<artifactId>ride-client</artifactId>
<version>1.0-SNAPSHOT</version>

<!-- configs that can be referenced eg.${java.version}-->
<properties>
    <java.version>1.8</java.version>
    <maven.compiler.plugin.version>3.8.1</maven.compiler.plugin.version>
    <maven.compiler.source>1.8</maven.compiler.source>  <!-- you are using Java 8 features, compatiable up to Java 8 -->
    <maven.compiler.target>1.8</maven.compiler.target>  <!-- generated bytecode is compatible with Java 8 runtime environments. -->
</properties>

<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <version>2.1.6.RELEASE</version>
        <scope>test</scope>
        <exclustions>
            <exclusion>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
            </exclusion>
        </exclustions>
    </dependency>
</dependencies>

<build>
  <extensions>
      <extension>
        <groupId>kr.motd.maven</groupId>
        <artifactId>os-maven-plugin</artifactId>
        <version>1.7.1</version>
      </extension>
  </extensions>
  <plugins>
      <plugin>
      <groupId>org.xolstice.maven.plugins</groupId>
      <artifactId>protobuf-maven-plugin</artifactId>
      <version>0.6.1</version>
      <configuration>
          <protocArtifact>com.google.protobuf:protoc:3.24.0:exe:${os.detected.classifier}</protocArtifact>
          <pluginId>grpc-java</pluginId>
          <pluginArtifact>io.grpc:protoc-gen-grpc-java:1.59.0:exe:${os.detected.classifier}</pluginArtifact>
      </configuration>
      <executions>
          <execution>
          <goals>
              <goal>compile</goal>
              <goal>compile-custom</goal>
          </goals>
          </execution>
      </executions>
      </plugin>
  </plugins>
</build>
```

### Multi-Modules

- multi-module project
  - `modules`: sub-project inside a project, `inherite dependencies from parent`
  - `dependencyManagement`: used in the parent POM to provide consistent dependency information to all child modules
    - define `dependencies`, Child modules will inherit the dependencies and version
    - children can still override the dependency version/scope in their pom.
  - `pluginManagement`: similar to dependencyManagement
  - `parent`: (for child module) specify the parent project

```xml
<!-- in parent module -->
<modules>
  <module>child-project1</module>
  <module>child-project2</module>
</modules>

<dependencyManagement>
  <dependencies>
      <dependency>
          <groupId>org.springframework.boot</groupId>
          <artifactId>spring-boot-starter-test</artifactId>
          <version>2.1.6.RELEASE</version>
          <scope>test</scope>
          <exclustions>
              <exclusion>
                  <groupId>junit</groupId>
                  <artifactId>junit</artifactId>
              </exclusion>
          </exclustions>
      </dependency>
  </dependencies>
</dependencyManagement>

<!-- in child module -->
<parent>
  <groupId>com.example</groupId>
  <artifactId>ride-client</artifactId>
  <version>1.0-SNAPSHOT</version>
</parent>
```

### Build Lifecycle

- Build Lifecycle: Compile -> Test -> PackagePackage -> Integration Test -> Install -> deploy

- mvn compile

  - Maven compile the source code to bytecode
  - Maven compare `.pom` and `Local Maven Repository`, try to find and then download missing dependencies from `Central Maven Repository`
  - ❗Maven do not bundled dependencies into your JAR file by default
    - `Uber JAR` (fat JAR): use plugins like `Maven Shade Plugin` to package dependencies into the JAR file

- `mvn package`: package compiled code into JAR (Artifact)

- `mvn install`: compiles your project, packages it, and then `installs` the resulting artifacts into `local repository`

### Commands

```bash
# install mvn
mvn
# maven warpper: a script, don't need maven install locally
.\mvnw      # (powershell) use maven warpper(run without maven installed)
./mvnw      # linux, mac

# frequently used
mvn clean package #  Cleans the target directory, compile src, Executes any tests, Packages into JAR
mvn clean install     # mvn package then push(install) to your local maven repository

# Build Lifecycle
mvn clean       # clean the `target` folder
mvn complie     # complie to "target" folder
mvn test        # complie `src` the production folder and run tests defined in the `test` folder
mvn package
# integration-test
mvn install

# Spring
mvn spring-boot:run     # compile applications code and run compiled code  => target folder
mvn clean spring-boot:run     # clean target before spring-boot:run
```
